# Makefile for Roots
# Requires AMU 5.16 or later


include include/mk

CC = cc
MAKE = amu
LINK ?= link


CCFLAGS = -c -throwback -depend !Depend -IC: $(EXTRAFLAGS) -strict -fah $(FLAGS)

NORMALLIBS = \
	C:o.stubs\
	C:Lua.lib.luacore\
	C:Lua.lib.luastdlib\
	C:AJWLib.o.AJWLib\
	C:Desk.o.Desk

32BITLIBS = \
	C32:o.stubs\
	C32:Lua.lib.luacore\
	C32:Lua.lib.luastdlib\
	C32:AJWLib.o.AJWLib\
	C32:Desk.o.Desk

MEMCHECKLIBS = \
	C:stubs.o.asstubs\
	C:Lua.lib.luacoremc\
	C:Lua.lib.luastdlibmc\
	C:AJWLib.mc.AJWLib\
	MemCheck:o.MC\
	C:Desk.o.Desk

LIBS ?= $(NORMALLIBS)

OBJECTS = \
	Modules.o\
	Graphics.o\
	Windows.o\
	TreeLayout.o\
	Config.o\
	Layout.o\
	Draw.o\
	File.o\
	Print.o\
	Drawfile.o\
	Database.o\
	Shareware.o\
	EditGraphics.o\
	Main.o

TARGET = !RunImage

all: $(TARGET)

$(TARGET): $(OBJECTS)
	$(LINK) -o $@ $(LINKFLAGS) $(OBJECTS) $(LIBS)
	$(SQUEEZE)

.c.o:
	$(MEMCHECK) $(CC) $(CCFLAGS) $< -o $@

#dist: normal
#	rm log
#	rm clf
#	cd ..
#	rm webjames.zip
#	copy C:regex !WebJames.regex A~C~DF~L~N~P~QRS~T~V
#	zip -r -9 webjames/zip !WebJames Site Licence -x */o/* o/* *Makefile *CVS* *Debug* *zip* *regex/main
#	rm !WebJames.regex
#	cd !WebJames

debug: clean
	echo |JEXTRAFLAGS = -g|JLINK = drlink|JLINKFLAGS = -d { > include/mk }
	$(MAKE)

normal: clean
	echo |JEXTRAFLAGS = -Otime|JSQUEEZE = Squeeze -f $(TARGET) { > include/mk }
	$(MAKE)

32bit: clean
	echo |JLIBS = $(32BITLIBS)|JEXTRAFLAGS = -APCS 3/32bit/fpe3 { > include/mk }
	$(MAKE)

memcheck: clean
	echo |JLIBS = $(MEMCHECKLIBS)|JMEMCHECK = Memcheck.CC|JEXTRAFLAGS = -g|JLINK = drlink|JLINKFLAGS = -d { > include/mk }
	$(MAKE)

#!Run: !Run-in
#	sed $(REGEXP) < !Run-in > !Run
#	SetType !Run Obey

clean:
	rm *.o
	rm $(TARGET)


# Dynamic dependencies:
o.Graphics: c.Graphics C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error C:Desk.h.DeskMem C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.SWI C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.GFX C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:Desk.h.Str C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.File C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.Str C:AJWLib.h.File C:AJWLib.h.Font C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile C:AJWLib.h.Assert C:AJWLib.h.Error2 C:Lua.h.Lua C:Lua.h.LuaLib C:Lua.h.lua h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.Draw h.File C:Desk.h.Save
o.Windows: c.Windows C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error C:Desk.h.Error2 C:Desk.h.SWI C:Desk.h.WimpSWIs C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.GFX C:Desk.h.Save C:Desk.h.Kbd C:Desk.h.Keycodes C:Desk.h.Str C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:AJWLib.h.Error2 C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Assert C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.Font C:AJWLib.h.File C:AJWLib.h.Str C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile h.Main h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Modules h.Database h.DatabaseStruct h.LayoutStruct h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.TreeLayout h.Layout h.Database h.Drawfile h.Draw h.File C:Desk.h.Save h.Print
o.TreeLayout: c.TreeLayout C:Desk.h.Core C:h.kernel C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.WimpSWIs C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Event C:Desk.h.DeskMem C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.File C:AJWLib.h.Assert h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Modules h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.TreeLayout h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.Layout h.File C:Desk.h.Save h.Config h.LayoutStruct
o.Config: c.Config C:Desk.h.Core C:h.kernel C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Icon C:Desk.h.Error C:Desk.h.Error2 C:Desk.h.File C:Desk.h.SWI C:Desk.h.Filing C:Desk.h.Msgs C:Desk.h.Menu C:Desk.h.Event C:Desk.h.Event C:Desk.h.Template C:Desk.h.Sprite C:Desk.h.LinkList C:AJWLib.h.Assert C:AJWLib.h.Error2 C:AJWLib.h.File C:AJWLib.h.Str C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Menu h.Config h.LayoutStruct h.DatabaseStruct h.Modules h.Database h.DatabaseStruct h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.DatabaseStruct
o.Layout: c.Layout C:Desk.h.Core C:h.kernel C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.WimpSWIs C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Event C:Desk.h.DeskMem C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.File C:AJWLib.h.Assert h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Modules h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.File C:Desk.h.Save h.Config h.LayoutStruct C:Desk.h.Window C:Desk.h.Error C:Desk.h.Error2 C:Desk.h.SWI C:Desk.h.WimpSWIs C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.GFX C:Desk.h.Save C:Desk.h.Kbd C:Desk.h.Str C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:AJWLib.h.Error2 C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Assert C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.Flex C:AJWLib.h.Font C:AJWLib.h.File C:AJWLib.h.Str C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile h.Main h.Graphics h.Modules h.Windows h.Config h.Layout h.TreeLayout h.Layout h.Database h.Drawfile h.Draw h.File h.Print
o.Draw: c.Draw C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.Core C:h.kernel C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.Wimp C:Desk.h.ColourTran C:Desk.h.SWI C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.Assert h.Config h.LayoutStruct h.DatabaseStruct h.Draw
o.File: c.File C:Desk.h.Error C:Desk.h.Core C:h.kernel C:Desk.h.Error2 C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Msgs C:Desk.h.File C:Desk.h.SWI C:Desk.h.Icon C:Desk.h.Wimp C:Desk.h.DragASpr C:Desk.h.KernelSWIs C:Desk.h.DeskMem C:Desk.h.Window C:Desk.h.WimpSWIs C:Desk.h.Pointer C:Desk.h.Coord C:Desk.h.Core C:Desk.h.str C:Desk.h.Hourglass C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Error2 C:AJWLib.h.File C:AJWLib.h.Assert h.Main h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.TreeLayout h.Layout h.File C:Desk.h.Save C:Desk.h.Event
o.Print: c.Print C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error C:Desk.h.Error2 C:Desk.h.SWI C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Keycodes C:Desk.h.GFX C:Desk.h.Save C:Desk.h.Str C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:Desk.h.PDriver C:Desk.h.Print C:AJWLib.h.Error2 C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Assert C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.Font C:AJWLib.h.File C:AJWLib.h.Str C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile MemCheck:h.MemCheck h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Modules h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.Drawfile h.Draw h.File C:Desk.h.Save h.Print
o.Drawfile: c.Drawfile C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error2 C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.DeskMem C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.SWI C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.GFX C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:Desk.h.SWI C:Desk.h.PDriver C:AJWLib.h.Error2 C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Assert C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.Font C:AJWLib.h.Str C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Modules h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.Drawfile
o.Database: c.Database C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error2 C:Desk.h.Event C:Desk.h.Template C:Desk.h.Sprite C:Desk.h.LinkList C:Desk.h.File C:Desk.h.SWI C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.DeskMem C:Desk.h.Filing C:Desk.h.Str C:AJWLib.h.Assert C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Error2 C:AJWLib.h.Menu C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Menu C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.File h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Modules h.File C:Desk.h.Save h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.DatabaseStruct h.Config h.LayoutStruct h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Shareware
o.Shareware: c.Shareware C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error2 C:Desk.h.Msgs C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Error2 h.Main h.Config h.LayoutStruct h.DatabaseStruct h.Shareware
o.Main: c.Main MemCheck:h.MemCheck C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error2 C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.Str C:Desk.h.File C:Desk.h.SWI C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.GFX C:Desk.h.Hourglass C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Error2 C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.DrawFile C:Desk.h.Wimp h.Main h.Modules h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.File C:Desk.h.Save h.Config h.LayoutStruct h.Shareware
o.Modules: c.Modules C:Desk.h.Core C:h.kernel C:Desk.h.Wimp C:Desk.h.Coord C:Desk.h.Core h.Modules h.Database h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.Database h.Graphics C:Desk.h.Wimp h.DatabaseStruct h.LayoutStruct h.Windows h.DatabaseStruct h.LayoutStruct h.WindowsStruct h.DatabaseStruct h.File C:Desk.h.Save C:Desk.h.Event h.Config h.LayoutStruct h.Print h.Layout h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.EditGraphics
o.EditGraphics: c.EditGraphics C:Desk.h.Window C:Desk.h.Wimp C:Desk.h.Core C:h.kernel C:Desk.h.WimpSWIs C:Desk.h.Error2 C:Desk.h.Error C:Desk.h.JumpRaw C:Desk.h.Debug C:Desk.h.Pointer C:Desk.h.Icon C:Desk.h.DragASpr C:Desk.h.Coord C:Desk.h.Core C:Desk.h.Error C:Desk.h.Error2 C:Desk.h.SWI C:Desk.h.Event C:Desk.h.EventMsg C:Desk.h.Handler C:Desk.h.Hourglass C:Desk.h.Icon C:Desk.h.Menu C:Desk.h.Msgs C:Desk.h.Drag C:Desk.h.Resource C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Template C:Desk.h.LinkList C:Desk.h.File C:Desk.h.Filing C:Desk.h.Sprite C:Desk.h.Screen C:Desk.h.Keycodes C:Desk.h.GFX C:Desk.h.Save C:Desk.h.Str C:Desk.h.Font2 C:Desk.h.Font C:Desk.h.ColourTran C:Desk.h.PDriver C:Desk.h.Pane2 C:AJWLib.h.Error2 C:AJWLib.h.Window C:Desk.h.Sprite C:AJWLib.h.Menu C:AJWLib.h.Assert C:AJWLib.h.Msgs C:Desk.h.Window C:Desk.h.Icon C:AJWLib.h.Icon C:AJWLib.h.Flex C:Desk.h.Core C:h.kernel C:AJWLib.h.Font C:AJWLib.h.File C:AJWLib.h.Str C:AJWLib.h.Draw C:AJWLib.h.DrawFile C:Desk.h.Wimp C:AJWLib.h.DrawFile h.EditGraphics h.Draw h.Windows h.DatabaseStruct h.LayoutStruct h.DatabaseStruct h.WindowsStruct h.DatabaseStruct
